!function(e){function t(t,s,r,i){t.value=e(s).text(),e(t).change(),t.focus(),r.hide()}function s(e,t){if(e)return i(t,e)}function r(e,t){if("object"==typeof e)return function(e){return e.setFullYear(2001),e.setMonth(0),e.setDate(0),e}(e);for(var s,r,n=t.timeFormat.match(/(hh?|HH?|mm?|ss?|tt?)/g),o=i(t,!1),a=new RegExp("^"+o+"$"),c=e.match(a),u=-1,l=-1,f=0,m=t.amDesignator,d=t.pmDesignator,h=0;h<n.length;h++)if(c&&c[h+1])switch(n[h]){case"hh":case"h":u=parseInt(c[h+1],10);break;case"HH":case"H":u=parseInt(c[h+1],10);break;case"mm":case"m":l=parseInt(c[h+1],10);break;case"ss":case"s":f=parseInt(c[h+1],10);break;case"t":m=m.substring(0,1),d=d.substring(0,1);case"tt":s=c[h+1]}if(12===u&&s===m?u=0:12!==u&&s===d&&(u+=12),(r=new Date(2001,0,0,u,l,f)).getHours()!=u||r.getMinutes()!=l||r.getSeconds()!=f)throw"Invalid time";return r}function i(e,t){var s=function(e){return e<10?"0"+e:e};return e.timeFormat.replace(/hh?|HH?|mm?|ss?|tt?/g,function(r){var i=e.amDesignator,n=e.pmDesignator;switch(r){case"hh":return t?s((t.getHours()+11)%12+1):"([0-1][0-9])";case"h":return t?(t.getHours()+11)%12+1:"([0-1]?[0-9])";case"HH":return t?s(t.getHours()):"([0-2][0-9])";case"H":return t?t.getHours():"([0-2]?[0-9])";case"mm":return t?s(t.getMinutes()):"([0-6][0-9])";case"m":return t?t.getMinutes():"([0-6]?[0-9])";case"ss":return t?s(t.getSeconds()):"([0-6][0-9])";case"s":return t?t.getSeconds():"([0-6]?[0-9])";case"t":return t?t.getHours()<12?i.substring(0,1):n.substring(0,1):"("+i.substring(0,1)+"|"+n.substring(0,1)+")";case"tt":return t?t.getHours()<12?i:n:"("+i+"|"+n+")"}return""})}e.fn.timePicker=function(t){if(void 0!==t&&(void 0!==t.separator||void 0!==t.show24Hours)&&!t.timeFormat){var s=void 0===t.show24Hours||t.show24Hours;t.timeFormat=(s?"HH":"hh")+(void 0!==t.separator?t.separator:":")+"mm"+(s?"":" tt")}var r=e.extend({},e.fn.timePicker.defaults,t);return this.each(function(){e.timePicker(this,r)})},e.timePicker=function(t,s){var r=e(t)[0];return r.timePicker||(r.timePicker=new jQuery._timePicker(r,s))},e.timePicker.version="0.4",e.timePicker.formatTime=function(t,r,i){return(i=i||e.fn.timePicker.defaults).timeFormat=t,s(r,i)},e.timePicker.parseTime=function(t,s,i){return(i=i||e.fn.timePicker.defaults).timeFormat=t,r(s,i)},e._timePicker=function(i,n){var o=!1,a=!1,c=r(n.startTime,n),u=r(n.endTime,n);e(i).attr("autocomplete","OFF");for(var l=[],f=new Date(c);f<=u;)l[l.length]=s(f,n),f=new Date(f.setMinutes(f.getMinutes()+n.step));for(var m=e('<div class="time-picker'+(n.show24Hours?"":" time-picker-12hours")+'"></div>'),d=e("<ul></ul>"),h=0;h<l.length;h++)d.append("<li>"+l[h]+"</li>");m.append(d),m.appendTo("body").hide(),m.mouseover(function(){o=!0}).mouseout(function(){o=!1}),e("li",d).mouseover(function(){a||(e("li.selected",m).removeClass("selected"),e(this).addClass("selected"))}).mousedown(function(){o=!0}).click(function(){t(i,this,m,n),o=!1});var g=function(){if(m.is(":visible"))return!1;e("li",m).removeClass("selected");var t=e(i).offset();m.css({top:t.top+i.offsetHeight,left:t.left}),m.show();var o=c;if(i.value)try{o=r(i.value,n);var a=60*c.getHours()+c.getMinutes(),l=60*o.getHours()+o.getMinutes()-a,f=Math.round(l/n.step),d=new Date(2001,0,0,0,f*n.step+a,0);o=c<d&&d<=u?d:c}catch(e){}var h=e("li:contains("+s(o,n)+")",m);return h.length&&(h.addClass("selected"),m[0].scrollTop=h[0].offsetTop),!0};e(i).focus(g).click(g),e(i).blur(function(){o||m.hide()}),e(i).keydown(function(s){var r;a=!0;var o=m[0].scrollTop;switch(s.keyCode){case 38:if(g())return!1;var c=(r=e("li.selected",d)).prev().addClass("selected")[0];return c?(r.removeClass("selected"),c.offsetTop<o&&(m[0].scrollTop=o-c.offsetHeight)):(r.removeClass("selected"),c=e("li:last",d).addClass("selected")[0],m[0].scrollTop=c.offsetTop-c.offsetHeight),!1;case 40:if(g())return!1;var u=(r=e("li.selected",d)).next().addClass("selected")[0];return u?(r.removeClass("selected"),u.offsetTop+u.offsetHeight>o+m[0].offsetHeight&&(m[0].scrollTop=o+u.offsetHeight)):(r.removeClass("selected"),u=e("li:first",d).addClass("selected")[0],m[0].scrollTop=0),!1;case 13:if(m.is(":visible")){var l=e("li.selected",d)[0];t(i,l,m,n)}return!1;case 27:return m.hide(),!1}return!0}),e(i).keyup(function(e){a=!1}),this.getTime=function(){return r(i.value,n)},this.setTime=function(t){i.value=s(r(t,n),n),e(i).change()}},e.fn.timePicker.defaults={step:30,startTime:new Date(0,0,0,0,0,0),endTime:new Date(0,0,0,23,30,0),timeFormat:"HH:mm",amDesignator:"AM",pmDesignator:"PM"}}(jQuery);
